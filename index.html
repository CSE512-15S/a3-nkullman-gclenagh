<!DOCTYPE html>
<meta charset="utf-8">
<style>

body {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  margin: auto;
  position: relative;
  width: 960px;
}

text {
  font: 10px sans-serif;
}

form {
  position: absolute;
  right: 10px;
  top: 10px;
}

</style>
<form>
  <label><input type="radio" name="dataset" value="alldays" checked>All Days</label>
  <label><input type="radio" name="dataset" value="weekdays">Weekdays</label>
  <label><input type="radio" name="dataset" value="weekends">Weekends</label>
</form>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script>
d3.csv("fremont.csv", function(csv)
{
	var data = d3.nest()
		.key(function(d) {return d.Direction;})
		.key(function(d) {return d.Time;})
		.sortKeys(d3.ascending)
		.rollup(function(d)
		{
			return d3.mean(d, function(g) {return +g.CyclistCount;});
		})
		.map(csv);
	
	d3.selectAll("input")
		.on("change", change);
	
	function change()
	{
		var value = this.value;
		if (value == "weekdays")
		{
			csv_filtered = csv.filter(function(d) { return d.IsWeekday == "TRUE"; });
		} else if (value == "weekends")
		{
			csv_filtered = csv.filter(function(d) { return d.IsWeekday == "FALSE"; });
		} else 
		{
			csv_filtered = csv;
		}
		
		data = d3.nest()
		.key(function(d) {return d.Direction;})
		.key(function(d) {return d.Time;})
		.sortKeys(d3.ascending)
		.rollup(function(d)
		{
			return d3.mean(d, function(g) {return +g.CyclistCount;});
		})
		.map(csv_filtered);
	}
});
</script>